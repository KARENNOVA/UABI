import { FC, useEffect, useRef, useState } from 'react';
import MapView from '@arcgis/core/views/MapView';
import _Map from '@arcgis/core/Map';
import SimpleRenderer from '@arcgis/core/renderers/SimpleRenderer';
import GeoJSONLayer from '@arcgis/core/layers/GeoJSONLayer';
import SimpleFillSymbol from '@arcgis/core/symbols/SimpleFillSymbol';
import FeatureLayer from '@arcgis/core/layers/FeatureLayer';
import BasemapToggle from "@arcgis/core/widgets/BasemapToggle";
import BasemapGallery from "@arcgis/core/widgets/BasemapGallery";

interface MapProps {
    center?: [number, number];
    zoom?: number;
}

const Map: FC<MapProps> = ({ center, zoom }) => {
    const ref = useRef(false);
    const [view, set_view] = useState<MapView>(null);
    useEffect(() => {
        if (!ref.current) {
            ref.current = true;
        } else {
            const url =
                'https://www.medellin.gov.co/mapas/rest/services/ServiciosSuministros_y_Servicios/BienesInmuebles/MapServer/1/query?where=CBML%3D10130340011&f=geojson';

            const _map = new _Map({
                basemap: 'arcgis-navigation', // Basemap layer service
            });
            const _view = new MapView({
                map: _map,
                center, // Longitude, latitude
                zoom, // Zoom level
                container: 'viewDiv',
            });

            const featureLayer = new FeatureLayer({
                url,
            });

            _map.add(featureLayer);

            set_view(_view);
        }
    }, [ref.current]);
    return <div id="viewDiv" className="w-100" style={{ height: 400 }} />;
};

Map.defaultProps = {
    center: [-75.56359, 6.25184],
    zoom: 13,
};

export default Map;
